<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' blob: data:;" />
  <meta name="color-scheme" content="light dark" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MermaidPad Preview</title>
  <style>
    /* Paint correctly on first frame based on OS theme */
    html, body {
      margin: 0;
      height: 100%;
      background: #fff;
      color: #222;
    }

    @media (prefers-color-scheme: dark) {
      html, body {
        background: #1e1e1e;
        color: #ddd;
      }
    }

    body.dark-theme {
      background: #000;
      color: #ddd;
    }

    body.light-theme {
      background: #fff;
      color: #222;
    }

    /* CSS custom property for transition duration */
    :root {
      --loading-transition-duration: 300ms;
    }

    #output {
      padding: 8px;
      overflow: auto;
      height: 100vh;
      box-sizing: border-box;
      display: none;
    }

      #output.visible {
        display: block;
      }

    .error {
      color: #ff6f6f;
      white-space: pre;
      font-family: Consolas,monospace;
    }

    /* Loading indicator styles */
    #loading-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      transition: opacity var(--loading-transition-duration) ease-out, visibility 0s ease-out var(--loading-transition-duration);
    }

      #loading-container.hidden {
        opacity: 0;
        visibility: hidden;
        pointer-events: none;
      }

    .spinner {
      width: 2.5rem;
      height: 2.5rem;
      border: 0.1875rem solid rgba(0, 0, 0, 0.1);
      border-top-color: #007acc;
      border-radius: 50%;
      animation: spinner-rotate 0.8s cubic-bezier(0.4, 0, 0.2, 1) infinite;
    }

    body.dark-theme .spinner {
      border-color: rgba(255, 255, 255, 0.1);
      border-top-color: #4db8ff;
    }

    #loading-container.hidden .spinner {
      animation: none;
    }

    @keyframes spinner-rotate {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    #loading-status {
      position: absolute;
      top: calc(50% + 3rem);
      left: 50%;
      transform: translate(-50%, 0);
      font-size: 1rem;
      color: #666;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      white-space: nowrap;
      will-change: transform;
    }

    body.dark-theme #loading-status {
      color: #aaa;
    }

    /* Mermaid dark theme overrides */
    body.dark-theme #output svg .messageLine,
    body.dark-theme #output svg .actor-line,
    body.dark-theme #output svg .mermaid .edgePath path,
    body.dark-theme #output svg .mermaid .node rect,
    body.dark-theme #output svg .mermaid .node circle,
    body.dark-theme #output svg .mermaid .node ellipse {
      stroke: #e0e0e0 !important;
    }

    body.dark-theme #output svg text,
    body.dark-theme #output svg .messageText {
      fill: #e0e0e0 !important;
    }

    /* ============================================
    HOVER HIGHLIGHTING STYLES FOR MERMAID DIAGRAMS
    ============================================ */

    /* Enable smooth transitions for all interactive elements */
    #output svg .node,
    #output svg .edgePath path,
    #output svg .flowchart-link,
    #output svg .actor,
    #output svg .activation,
    #output svg rect,
    #output svg circle,
    #output svg ellipse,
    #output svg polygon,
    #output svg path,
    #output svg .messageText,
    #output svg .labelText,
    #output svg .nodeLabel,
    #output svg .edgeLabel {
      transition: all 0.2s ease-in-out;
      cursor: pointer;
    }

    /* ============================================
    LIGHT THEME HOVER EFFECTS
    ============================================ */

    /* Node hover effects - Light theme */
    body.light-theme #output svg .node:hover rect,
    body.light-theme #output svg .node:hover circle,
    body.light-theme #output svg .node:hover ellipse,
    body.light-theme #output svg .node:hover polygon {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
    }

    /* Node label hover - Light theme */
    body.light-theme #output svg .node:hover .nodeLabel,
    body.light-theme #output svg .node:hover text {
      font-weight: 600 !important;
      fill: #005a9e !important;
    }

    /* Edge/Path hover effects - Light theme */
    body.light-theme #output svg .edgePath:hover path,
    body.light-theme #output svg .flowchart-link:hover {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 6px rgba(0, 122, 204, 0.5));
    }

    /* Edge label hover - Light theme */
    body.light-theme #output svg .edgeLabel:hover,
    body.light-theme #output svg .edgeLabel:hover text {
      fill: #005a9e !important;
      font-weight: 600 !important;
    }

    /* Sequence diagram specific - Light theme */
    body.light-theme #output svg .actor:hover rect,
    body.light-theme #output svg .actor:hover circle {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
    }

    body.light-theme #output svg .activation:hover rect {
      fill: #cce5ff !important;
      stroke: #007acc !important;
      stroke-width: 2px !important;
    }

    body.light-theme #output svg .messageLine:hover {
      stroke: #007acc !important;
      stroke-width: 2.5px !important;
    }

    /* Class diagram specific - Light theme */
    body.light-theme #output svg .classGroup:hover rect {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
    }

    /* State diagram specific - Light theme */
    body.light-theme #output svg .stateGroup:hover rect,
    body.light-theme #output svg .stateGroup:hover circle {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
    }

    /* ============================================
    DARK THEME HOVER EFFECTS
    ============================================ */

    /* Node hover effects - Dark theme */
    body.dark-theme #output svg .node:hover rect,
    body.dark-theme #output svg .node:hover circle,
    body.dark-theme #output svg .node:hover ellipse,
    body.dark-theme #output svg .node:hover polygon {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 10px rgba(77, 184, 255, 0.7));
    }

    /* Node label hover - Dark theme */
    body.dark-theme #output svg .node:hover .nodeLabel,
    body.dark-theme #output svg .node:hover text {
      font-weight: 600 !important;
      fill: #ffffff !important;
      filter: drop-shadow(0 0 4px rgba(77, 184, 255, 0.8));
    }

    /* Edge/Path hover effects - Dark theme */
    body.dark-theme #output svg .edgePath:hover path,
    body.dark-theme #output svg .flowchart-link:hover {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(77, 184, 255, 0.6));
    }

    /* Edge label hover - Dark theme */
    body.dark-theme #output svg .edgeLabel:hover,
    body.dark-theme #output svg .edgeLabel:hover text {
      fill: #ffffff !important;
      font-weight: 600 !important;
      filter: drop-shadow(0 0 4px rgba(77, 184, 255, 0.8));
    }

    /* Sequence diagram specific - Dark theme */
    body.dark-theme #output svg .actor:hover rect,
    body.dark-theme #output svg .actor:hover circle {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 10px rgba(77, 184, 255, 0.7));
    }

    body.dark-theme #output svg .activation:hover rect {
      fill: #1a4d6b !important;
      stroke: #4db8ff !important;
      stroke-width: 2px !important;
    }

    body.dark-theme #output svg .messageLine:hover {
      stroke: #4db8ff !important;
      stroke-width: 2.5px !important;
      filter: drop-shadow(0 0 6px rgba(77, 184, 255, 0.5));
    }

    /* Class diagram specific - Dark theme */
    body.dark-theme #output svg .classGroup:hover rect {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 10px rgba(77, 184, 255, 0.7));
    }

    /* State diagram specific - Dark theme */
    body.dark-theme #output svg .stateGroup:hover rect,
    body.dark-theme #output svg .stateGroup:hover circle {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 10px rgba(77, 184, 255, 0.7));
    }

    /* ============================================
    ADDITIONAL HOVER ENHANCEMENTS
    ============================================ */

    /* Pie chart segments */
    body.light-theme #output svg .pieCircle:hover {
      filter: brightness(1.2) drop-shadow(0 0 8px rgba(0, 122, 204, 0.6));
      transform: scale(1.05);
      transform-origin: center;
    }

    body.dark-theme #output svg .pieCircle:hover {
      filter: brightness(1.3) drop-shadow(0 0 10px rgba(77, 184, 255, 0.7));
      transform: scale(1.05);
      transform-origin: center;
    }

    /* Gantt chart bars */
    body.light-theme #output svg .task:hover {
      filter: brightness(1.15) drop-shadow(0 0 6px rgba(0, 122, 204, 0.5));
    }

    body.dark-theme #output svg .task:hover {
      filter: brightness(1.25) drop-shadow(0 0 8px rgba(77, 184, 255, 0.6));
    }

    /* Generic rect elements (fallback for all diagram types) */
    body.light-theme #output svg rect:hover {
      stroke: #007acc !important;
      stroke-width: 2.5px !important;
    }

    body.dark-theme #output svg rect:hover {
      stroke: #4db8ff !important;
      stroke-width: 2.5px !important;
    }

    /* Improve hover cursor for all interactive elements */
    #output svg .node,
    #output svg .edgePath,
    #output svg .actor,
    #output svg .classGroup,
    #output svg .stateGroup,
    #output svg .task,
    #output svg .pieCircle {
      cursor: pointer;
    }

    /* Prevent text selection during hover interactions */
    #output svg text {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    /* ============================================
    CLASS-BASED HOVER EFFECTS (for JavaScript-triggered hovers)
    ============================================ */

    /* Light theme - class-based hover for paths/edges */
    body.light-theme #output svg path.hover-active,
    body.light-theme #output svg .edgePath path.hover-active,
    body.light-theme #output svg .flowchart-link.hover-active {
      stroke: #007acc !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 6px rgba(0, 122, 204, 0.5));
    }

    body.light-theme #output svg line.hover-active,
    body.light-theme #output svg .messageLine.hover-active {
      stroke: #007acc !important;
      stroke-width: 2.5px !important;
    }

    /* Dark theme - class-based hover for paths/edges */
    body.dark-theme #output svg path.hover-active,
    body.dark-theme #output svg .edgePath path.hover-active,
    body.dark-theme #output svg .flowchart-link.hover-active {
      stroke: #4db8ff !important;
      stroke-width: 3px !important;
      filter: drop-shadow(0 0 8px rgba(77, 184, 255, 0.6));
    }

    body.dark-theme #output svg line.hover-active,
    body.dark-theme #output svg .messageLine.hover-active {
      stroke: #4db8ff !important;
      stroke-width: 2.5px !important;
      filter: drop-shadow(0 0 6px rgba(77, 184, 255, 0.5));
    }
  </style>

  <!-- Load js-yaml first -->
  <script src="js-yaml.min.js" id="jsyaml-script"></script>

  <!-- Load Mermaid -->
  <script src="mermaid.min.js" id="mermaid-script"></script>

  <!-- Load compiled TypeScript bundle -->
  <script type="module" src="bundle.js"></script>
</head>
<body>
  <div id="loading-container">
    <div class="spinner"></div>
    <div id="loading-status">Initializing...</div>
  </div>
  <div id="output"></div>
</body>
</html>
